main.py:99: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  X_tr = np.squeeze(np.array(list(X_tr)), axis=1)
main.py:103: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  X_ts = np.squeeze(np.array(list(X_ts)), axis=1)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_validation.py:517: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  estimator.fit(X_train, y_train, **fit_params)
/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/model_selection/_search.py:759: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  self.best_estimator_.fit(X, y, **fit_params)
/Users/vt908/Documents/git_repos/distribution_network/src/train.py:225: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  model.fit(X_tr, y_tr)
False
stratifying by patient
stratifying by patient
Missing inputs in train:  Counter()
Missing inputs in test:  Counter()
[[ True]
 [False]
 [False]
 ...
 [False]
 [False]
 [ True]]
(3347,)
(2,) (2,) (2,) (2,) (1,)
3347 3347 3347 3347 3347
(2,) (2,) (2,) (2,) (1,)
837 837 837 837 837
Traceback (most recent call last):
  File "main.py", line 114, in <module>
    train_score, test_score = train_sklearn_moments(X_tr, y_tr, X_ts, y_ts, name=name, model=args.model)
  File "/Users/vt908/Documents/git_repos/distribution_network/src/train.py", line 232, in train_sklearn_moments
    plot_partial_dependence(model, X_tr, features, feature_names, grid_resolution=20, percentiles=(0, 1))
  File "/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/inspection/_plot/partial_dependence.py", line 284, in plot_partial_dependence
    for fxs in features)
  File "/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/joblib-0.14.1-py3.6.egg/joblib/parallel.py", line 1004, in __call__
    if self.dispatch_one_batch(iterator):
  File "/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/joblib-0.14.1-py3.6.egg/joblib/parallel.py", line 835, in dispatch_one_batch
    self._dispatch(tasks)
  File "/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/joblib-0.14.1-py3.6.egg/joblib/parallel.py", line 754, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/joblib-0.14.1-py3.6.egg/joblib/_parallel_backends.py", line 209, in apply_async
    result = ImmediateResult(func)
  File "/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/joblib-0.14.1-py3.6.egg/joblib/_parallel_backends.py", line 590, in __init__
    self.results = batch()
  File "/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/joblib-0.14.1-py3.6.egg/joblib/parallel.py", line 256, in __call__
    for func, args, kwargs in self.items]
  File "/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/joblib-0.14.1-py3.6.egg/joblib/parallel.py", line 256, in <listcomp>
    for func, args, kwargs in self.items]
  File "/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/inspection/_partial_dependence.py", line 402, in partial_dependence
    grid_resolution
  File "/Users/vt908/opt/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/inspection/_partial_dependence.py", line 93, in _grid_from_X
    'percentiles are too close to each other, '
ValueError: percentiles are too close to each other, unable to build the grid. Please choose percentiles that are further apart.
